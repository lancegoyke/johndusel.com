# johndusel.com

A personal blog for one of my clients powered by **Django** and **Next.js**.

![Desktop screenshot](https://user-images.githubusercontent.com/26028162/225158718-4e205f11-863c-43e4-8a38-35df77d98b2b.png)

![Mobile screenshot](https://user-images.githubusercontent.com/26028162/225158832-0cca2dd4-3195-4843-b860-db1475e1b2c1.png)

## Features

- Backend
  - Authentication and models with [Django](https://www.djangoproject.com/)
  - API with [Django Rest Framework](https://www.django-rest-framework.org/)
  - Content editor from [TinyMCE](https://www.tiny.cloud/)
  - Database from [SQLite](https://www.sqlite.org/index.html)
- Frontend
  - Static site generated by [Next.js](https://nextjs.org/)
  - Styling inspired by [Every Layout](https://every-layout.dev/)
  - [RSS feed](https://johndusel.com/rss.xml)
- Deployment
  - Nginx reverse proxy serving static files with [Whitenoise](https://whitenoise.readthedocs.io/en/latest/)
  - Media files stored in [AWS S3](https://aws.amazon.com/s3/) with the help of [django-storages](https://django-storages.readthedocs.io/en/latest/)
  - [Gunicorn](https://gunicorn.org/) and [self-hosted `next start`](https://nextjs.org/docs/deployment#self-hosting) running as systemd services on an [AWS EC2](https://aws.amazon.com/ec2/) Ubuntu instance

## Overview

Django speaks to our database to store blog post and admin user data.

Next.js asks Django for our posts through two main function in our page component:

- `getStaticPaths()` to define each individual blog post
- `getStaticProps()` to populate the data for each blog post

The name of the file tells Next.js how to form the blog post URLs, i.e., `[slug].tsx` means use the `slug` to get our final paths. Hence, "get static paths."

## To Deploy Backend Updates

1. Pull the new code to the server
2. Migrate database changes with `python manage.py migrate`
3. Collect static files with `python manage.py collectstatic`
4. Restart gunicorn service

## To Deploy Frontend Update

1. Build the new code with `npm run build`
2. Restart the Next.js server with `npm run start`
